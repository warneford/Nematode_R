# Nematode_R
Project analyzing gene expression data from C. elegans embryos using R

Summary: 

  The scripts in this repository were written to extract data from the .csv output files from the Murray lab's implementation of 
StarryNite, specifically all files output from the perl function ./GetFiles.pl <list of movies> located in the tools3 directory.

  The scripts here will extract and aggregate all SCD files and auxillary info files. Then the blot data (the preferred measure of 
reporter quantification) is aggregated and normalized by two methods: Z axis position and scaling to a reference embryo.
The normalized blot data can then be graphically subsetted for cells with high reporter expression or variability at certain time points in 
embryogenesis.

  Reporter expression can then be plotted either for individual cells or for lineages of cells in the embryo, showing both 
  mean expression and variability over time and through cell divisions.
  
Scripts:

    SCD_pipeline.R  
    
    This script includes functions to import, trim, normalize and subset data for desired characteristics.
            Functions:
                      SCDProcess.R
                      ImportSCD.R
                      trimmingSCD.R
                      GroupEmb.R
                      Cell_Timeline.R
    
    Expression_Analysis.R
    
    This script analyses normalized data generated by SCDProcess.R / SCD_pipeline.R. It subsets data for cells with CV or mean expression
    of desired nature (high / low expression ; high / low variability). Reporter expression can then be plotted for specific cells or
    lineages of cells.
    
            Functions:
                      NormView.R
                      Sortblot2.R
                      PlotAllCells.R
                      PlotCell.R
                      PlotList.R
  
  Function glossary
  
  Filename        Function name (arguments)
  
  SCDProcess.R    SCDProcess(lineage, Rawdir)
                  Wrapper function to perform ImportSCD.R, trimmingSCD.R, GroupEmb.R, and Cell_Timeline.R. Takes two arguments: lineage 
                  (name of worm strain in .csv file names), Rawdir (directory containing data files)
  
  ImportSCD.R     ImportSCD(Directory)
                  ImportSCD extracts all SCD files present inside specified directory and outputs a list of data.frames
                  
                  Argument
                          Directory         Raw directory containing SCD files
                
  trimmingSCD.R   Trimming(df, Rawdir)
                  Trimming takes list of data.frames and trims empty values, aggregates all blot
                  data together, then creates a time column for blot data. Trimming also runs RepAuxInfo.R, a function that
                  extracts aux info .csv files and aggregates them. Specifically Trimming(..) assigns NA to blot values
                  in SCD files where x = 0 and y = 0, OR gweight = 0.
                  
                  Argument
                          df                list of data.frames that is the output of ImportSCD.R
                          Rawdir            directory containing raw data and auxinfo.csv files
                          
  RepAuxInfo.R    RepAuxfiles(Rawdir)
                  RepAuxfiles assembles all files ending in "AuxInfo.csv" and combines them into data frame
                  
                  Argument
                          Rawdir            name of directory containing files
  
  GroupEmb.R      GroupEmb(listdf)
                  GroupEmb groups SCD files by axis orientation (Left and Right) of embryo during imaging. Grouping is specified 
                  by data from RepAuxInfo.R (run inside trimmingSCD.R). Outputs two lists of dataframes corresponding to each
                  orientation.
                  
                  Argument
                          listdf            list of data frames, output from trimmingSCD.R
  
  Cell_Timeline.R BlotTime(listdf, groupdf)
                  BlotTime normalizes blot data to Z-plane, then normalizes it to a reference embryo. All this is done on axis-
                  grouped blot data as well as combined blot data. BlotTime then computes average blot values for each cell,
                  then deletes now un-needed SCD data files from data structure. Output is list of data frames.
                  
                  Argument
                          listdf            list of data frames, output from trimmingSCD.R
                          groupdf           list of data frames, output from GroupEmb.R
                          
  NormView.R      
                      


